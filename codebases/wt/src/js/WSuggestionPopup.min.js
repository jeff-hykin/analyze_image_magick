WT_DECLARE_WT_MEMBER(1,JavaScriptConstructor,"WSuggestionPopup",function(u,f,B,H,q,v,C,w,c){function d(a){return $(a).hasClass("Wt-suggest-onedit")||$(a).hasClass("Wt-suggest-dropdown")}function h(){return f.style.display!="none"}function k(a){f.style.display="block";e.positionAtWidget(f.id,a.id,e.Vertical)}function r(a){a=e.target(a||window.event);if(!e.hasTag(a,"UL")){for(;a&&!e.hasTag(a,"LI");)a=a.parentNode;a&&x(a)}}function x(a){var b=a.firstChild.firstChild,i=e.getElement(g),j=b.innerHTML;b=
b.getAttribute("sug");i.focus();B(i,j,b);u.emit(f,"select",a.id,i.id);m();g=null}function m(){f.style.display="none";if(g!=null&&D!=null){e.getElement(g).onkeydown=D;D=null}}function Q(a){var b=f.childNodes;for(n=a?b[0]:b[b.length-1];n;n=a?n.nextSibling:n.previousSibling)if(e.hasTag(n,"LI")&&n.style.display!="none")return n;return null}function S(a,b){for(a=b?a.nextSibling:a.previousSibling;a;a=b?a.nextSibling:a.previousSibling)if(e.hasTag(a,"LI"))if(a.style.display!="none")return a;return null}function I(a){var b=
a.parentNode;if(a.offsetTop+a.offsetHeight>b.scrollTop+b.clientHeight)b.scrollTop=a.offsetTop+a.offsetHeight-b.clientHeight;else if(a.offsetTop<b.scrollTop)b.scrollTop=a.offsetTop}$(".Wt-domRoot").add(f);f.wtObj=this;var s=this,e=u.WT,o=null,g=null,M=false,E=null,N=null,O=v,F=null,G=null,y=false;this.defaultValue=C;var D=null;this.showPopup=function(a){f.style.display="block";G=o=null;D=a.onkeydown;a.onkeydown=function(b){s.editKeyDown(this,b||window.event)}};this.editMouseMove=function(a,b){if(d(a))a.style.cursor=
e.widgetCoordinates(a,b).x>a.offsetWidth-16?"default":""};this.showAt=function(a,b){m();g=a.id;y=true;s.refilter(b)};this.editClick=function(a,b){if(d(a))if(e.widgetCoordinates(a,b).x>a.offsetWidth-16)if(g!=a.id||!h())s.showAt(a,"");else{m();g=null}};this.editKeyDown=function(a,b){if(!d(a))return true;if(g!=a.id)if($(a).hasClass("Wt-suggest-onedit")){g=a.id;y=false}else if($(a).hasClass("Wt-suggest-dropdown")&&b.keyCode==40){g=a.id;y=true}else{g=null;return true}if(h()){var i=o?e.getElement(o):null;
if(b.keyCode==13||b.keyCode==9){if(i){x(i);e.cancelEvent(b);setTimeout(function(){a.focus()},0)}else m();return false}else if(b.keyCode==40||b.keyCode==38||b.keyCode==34||b.keyCode==33){if(b.type.toUpperCase()=="KEYDOWN"){M=true;e.cancelEvent(b,e.CancelDefaultAction)}if(b.type.toUpperCase()=="KEYPRESS"&&M==true){e.cancelEvent(b);return false}var j=i,z=b.keyCode==40||b.keyCode==34;if(j){b=b.keyCode==34||b.keyCode==33?f.clientHeight/i.offsetHeight:1;var p;for(p=0;j&&p<b;++p){var t=S(j,z);if(!t&&c)break;
j=t}}else{j=Q(z);I(j)}if(i){i.className="";o=null}if(j&&e.hasTag(j,"LI")){j.className="active";o=j.id}return false}}return b.keyCode!=13&&b.keyCode!=9};this.filtered=function(a,b){E=a;O=b;s.refilter(G)};this.refilter=function(a){if(g){var b=o?e.getElement(o):null,i=e.getElement(g),j=H(i),z=f.childNodes,p=w&&a!=null?a:j(null);G=w?a:i.value;if(q>0||v)if(p.length<q&&!y){m();return}else{a=O?p:p.substring(0,Math.max(E!==null?E.length:0,q));if(a!=E)if(a!=N){N=a;u.emit(f,"filter",a)}}var t=a=null;p=y&&p.length==
0;var A,P;A=0;for(P=z.length;A<P;++A){var l=z[A];if(e.hasTag(l,"LI")){var J=l.firstChild;if(l.orig==null)l.orig=J.firstChild.innerHTML;var K=j(l.orig),T=p||K.match;if(K.suggestion!=J.firstChild.innerHTML)J.firstChild.innerHTML=K.suggestion;if(T){if(l.style.display!="")l.style.display="";if(a==null)a=l;if(A==this.defaultValue)t=l}else if(l.style.display!="none")l.style.display="none";if(l.className!="")l.className=""}}if(a==null)m();else{if(!h()){k(i);s.showPopup(i);b=null}if((c||t)&&(!b||b.style.display==
"none")){b=t||a;b.parentNode.scrollTop=0;o=b.id}if(b){b.className="active";I(b)}}}};this.editKeyUp=function(a,b){if(g!=null)if(d(a))if(!(!h()&&(b.keyCode==13||b.keyCode==9)))if(b.keyCode==27||b.keyCode==37||b.keyCode==39)m();else if(!(b.keyCode==40||b.keyCode==38||b.keyCode==34||b.keyCode==33))if(a.value!=G){g=a.id;s.refilter(a.value)}else(a=o?e.getElement(o):null)&&I(a)};f.onclick=r;f.onscroll=function(){if(F){clearTimeout(F);var a=e.getElement(g);a&&a.focus()}};this.delayHide=function(a){F=setTimeout(function(){F=
null;if(f&&(a==null||g==a.id))m()},300)}});
WT_DECLARE_WT_MEMBER(2,JavaScriptConstructor,"WSuggestionPopupStdMatcher",function(u,f,B,H,q,v,C){function w(c){var d=c.value;c=c.selectionStart?c.selectionStart:d.length;for(var h=B?d.lastIndexOf(B,c-1)+1:0;h<c&&H.indexOf(d.charAt(h))!=-1;)++h;return{start:h,end:c}}this.match=function(c){var d=w(c),h=c.value.substring(d.start,d.end),k;if(v.length==0)if(q.length!=0){k="(^|(?:[";for(c=0;c<q.length;++c){for(d=q.charCodeAt(c).toString(16);d.length<4;)d="0"+d;k+="\\u"+d}k+="]))"}else k="(^)";else k="("+
v+")";k+="("+h.replace(new RegExp("([\\^\\\\\\][\\-.$*+?()|{}])","g"),"\\$1")+")";k=new RegExp(k,"gi");return function(r){if(!r)return h;var x=false;if(h.length){var m=r.replace(k,"$1"+u+"$2"+f);if(m!=r){x=true;r=m}}return{match:x,suggestion:r}}};this.replace=function(c,d,h){d=w(c);var k=c.value.substring(0,d.start)+h+C;if(d.end<c.value.length)k+=c.value.substring(d.end,c.value.length);c.value=k;if(c.selectionStart){c.selectionStart=d.start+h.length+C.length;c.selectionEnd=c.selectionStart}}});
